LEA RAS
LEA RCS

TOG // mode 1
ADD RAS 64
ADD RAS 64
ADD RAS 64
MOV RBS 16 // mem[192] = 16

ADD RCS 64
ADD RCS 64
ADD RCS 64
ADD RCS 1
MOV RDS 0 // mem[193] = 0

TOG // mode 0
MOV [RAS] RBS
MOV [RCS] RDS

LEA RAS

TOG // mode 1
ADD RAS 64
ADD RAS 64
ADD RAS 32 // mem[160] = progress1
MOV RBS 0

TOG // mode 0
MOV [RAS] RBS

TOG // mode 1
MOV RC1 32  // RC1 outloop counter

TOG // mode 0
_outLoop:
    LEA RBS
    TOG // mode 1
    ADD RBS 64
    ADD RBS 64
    ADD RBS 32 // mem[160] = progress1

    TOG // mode 0
    MOV RAS [RBS]
    
    LEA RDS
    TOG // mode 1
    ADD RDS 64
    ADD RDS 64
    ADD RDS 32 
    DEC RDS // mem[159] = progress2
    MOV RBS 1
    ADD RBS 1
    TOG // mode 0
    MOV [RDS] RBS // initiate mem[159] = 2
 
    LEA RCS 
    TOG // mode 1
    ADD RCS 64
    ADD RCS 64
    ADD RCS 32
    ADD RCS 1  
    MOV RBS 0 // mem[161] = ones counter
    MOV RC2 32

    TOG // mode 0
    MOV [RCS] RBS

    _inLoop:
        LEA RBS
        TOG // mode 1
        ADD RBS 64
        ADD RBS 64
        ADD RBS 32 // mem[160] = progress1

        TOG // mode 0
        MOV RAS [RBS] // index of MSB1

        LEA RDS
        TOG // mode 1
        ADD RDS 64
        ADD RDS 64
        ADD RDS 32 
        DEC RDS // mem[159] = progress2

        TOG // mode 0
        MOV RCS [RDS]
        ADD RCS RAS

        TOG // mode 1
        ADD RCS 1
        ADD RCS 1

        TOG // mode 0
        MOV RAS [RAS] // MSB1
        MOV RCS [RCS] // MSB2

        XOR RAS RCS

        LEA RCS 
        TOG // mode 1
        ADD RCS 64
        ADD RCS 64
        ADD RCS 32
        ADD RCS 1

        TOG // mode 0
        MOV RCS [RCS] // RCS = ones counter 

        TOG // mode 1
        MOV RES 8 

        TOG // mode 0
        _countOnes1:
            TOG // mode 1
            MOV RDS 1 // bitmask
            TOG // mode 0
            AND RDS RAS
            JE _findOnes1
            SHR RAS
            TOG // mode 1
            DEC RES
            COM RES 0
            JE _endCount1
            TOG // mode 0
            JUMP _countOnes1

            _findOnes1:
                SHR RAS
                TOG // mode 1
                ADD RCS 1
                TOG // mode 0
                // save RCS ones counter
                LEA RAS 
                TOG // mode 1
                ADD RAS 64
                ADD RAS 64
                ADD RAS 32
                ADD RAS 1
                TOG // mode 0
                MOV [RAS] RCS
                TOG // mode 1
                DEC RES
                COM RES 0
                JE _endCount1
                TOG // mode 0
                JUMP _countOnes1

        _endCount1:
            TOG // mode 0
            LEA RBS
            TOG // mode 1
            ADD RBS 64
            ADD RBS 64
            ADD RBS 32 // mem[160] = progress1

            TOG // mode 0
            MOV RAS [RBS] // index of MSB1

            TOG // mode 1
            ADD RAS 1 // index of LSB1

            TOG // mode 0

            LEA RDS
            TOG // mode 1
            ADD RDS 64
            ADD RDS 64
            ADD RDS 32 
            DEC RDS // mem[159] = progress2

            TOG // mode 0
            MOV RCS [RDS]
            ADD RCS RAS

            TOG // mode 1
            ADD RCS 1
            ADD RCS 1

            TOG // mode 0
            MOV RAS [RAS] // LSB1
            MOV RCS [RCS] // LSB2

            XOR RAS RCS

            LEA RCS 
            TOG // mode 1
            ADD RCS 64
            ADD RCS 64
            ADD RCS 32
            ADD RCS 1

            TOG // mode 0
            MOV RCS [RCS] // RCS = ones counter 

            TOG // mode 1
            MOV RES 8 

            TOG // mode 0
            _countOnes2:
                TOG // mode 1
                MOV RDS 1 // bitmask
                TOG // mode 0
                AND RDS RAS
                JE _findOnes1
                SHR RAS
                TOG // mode 1
                DEC RES
                COM RES 0
                JE _endCount2
                TOG // mode 0
                JUMP _countOnes2

                _findOnes2:
                    SHR RAS
                    TOG // mode 1
                    ADD RCS 1
                    TOG // mode 0
                    // save RCS ones counter
                    LEA RAS 
                    TOG // mode 1
                    ADD RAS 64
                    ADD RAS 64
                    ADD RAS 32
                    ADD RAS 1
                    TOG // mode 0
                    MOV [RAS] RCS
                    TOG // mode 1
                    DEC RES
                    COM RES 0
                    JE _endCount2
                    TOG // mode 0
                    JUMP _countOnes2

        _endCount2:
            LEA RAS
            LEA RBS
            TOG // mode 1
            ADD RAS 64
            ADD RAS 64
            ADD RAS 64  // mem[192] = min_hamming
            ADD RBS 64
            ADD RBS 64
            ADD RBS 64
            ADD RBS 1  // mem[193] = max_hamming
            TOG // mode 0 
            MOV RAS [RAS]
            MOV RBS [RBS]
            LEA RCS 
            TOG // mode 1
            ADD RCS 64
            ADD RCS 64
            ADD RCS 32
            ADD RCS 1
            
            TOG // mode 0
            MOV RCS [RCS] // RCS = ones counter 
            CMP RCS RAS
            JLT _lessThan
            JUMP _gotocompare
        _lessThan:
            MOV [RAS] RCS
        _gotocompare:
            CMP RBS RCS
            JLT _greaterThan
            JUMP _gotonext
        _greaterThan:
            MOV [RBS] RCS
        _gotonext:
            LEA RDS
            TOG // mode 1
            ADD RDS 64
            ADD RDS 64
            ADD RDS 32 
            DEC RDS // mem[159] = progress2
            TOG // mode 0
            MOV RBS [RDS]
            TOG // mode 1
            ADD RBS 1
            ADD RBS 1
            TOG // mode 0
            MOV [RDS] RBS
            TOG // mode 1
            DEC RC2 
            CMP RC2 0
            JE _endinLoop
            TOG // mode 0
            JUMP _inLoop
    _endinLoop:
        TOG // mode 0
        LEA RAS
        TOG // mode 1
        ADD RAS 64
        ADD RAS 64
        ADD RAS 32 // mem[160] = progress1
        TOG // mode 0
        MOV RCS [RAS]
        TOG // mode 1
        ADD RCS 1
        ADD RCS 1
        TOG // mode 0
        MOV [RAS] RCS
        TOG // mode 1
        DEC RC1
        CMP RC1 0
        JE _endoutLoop
        TOG // mode 0
        JUMP _outLoop

_endoutLoop:
    LEA RAS
    LEA RBS

    TOG // mode 1
    ADD RAS 64
    ADD RAS 64
    ADD RAS 64  // mem[192] = min_hamming
    ADD RBS 64
    ADD RBS 64
    ADD RBS 64
    ADD RBS 1  // mem[193] = max_hamming
    TOG // mode 0 
    MOV RAS [RAS]
    MOV RBS [RBS]

    LEA RCS 
    TOG // mode 1
    ADD RCS 64
    TOG // mode 0
    MOV [RCS] RAS
    TOG // mode 1
    ADD RCS 1
    TOG // mode0 
    MOV [RCS] RBS